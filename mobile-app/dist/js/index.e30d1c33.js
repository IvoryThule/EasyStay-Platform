import{v as s,g as e,x as a,o as n,p as c,a2 as l,t as r,u as i,V as t,T as d,c as o,a3 as m,s as u}from"./vendors.8928da7e.js";import{r as h}from"./common.0834f2a9.js";var x={user:"\u666e\u901a\u7528\u6237",merchant:"\u5546\u5bb6",admin:"\u7ba1\u7406\u5458"};function j(){var j,N=s.useState(!!e("token")),p=a(N,2),f=p[0],g=p[1],k=s.useState(!1),v=a(k,2),b=v[0],w=v[1],C=s.useState({}),y=a(C,2),S=y[0],T=y[1],A=s.useState({total:0,pending:0,booked:0,canceled:0}),I=a(A,2),E=I[0],U=I[1],D=s.useCallback(n(c().m(function s(){var a,n,r,i,t,d;return c().w(function(s){while(1)switch(s.p=s.n){case 0:if(a=e("token"),n=!!a,g(n),n){s.n=1;break}return T({}),U({total:0,pending:0,booked:0,canceled:0}),s.a(2);case 1:return r=e("userInfo"),T(r||{}),w(!0),s.p=2,s.n=3,h({url:"/order/list",method:"GET"});case 3:i=s.v,200===i.code&&Array.isArray(i.data)&&(d=l(t=i.data).call(t,function(s,e){return s.total+=1,0===e.status&&(s.pending+=1),1===e.status&&(s.booked+=1),2===e.status&&(s.canceled+=1),s},{total:0,pending:0,booked:0,canceled:0}),U(d)),s.n=5;break;case 4:s.p=4,s.v;case 5:return s.p=5,w(!1),s.f(5);case 6:return s.a(2)}},s,null,[[2,4,5,6]])})),[]);r.useDidShow(function(){D()});var G=function(){r.navigateTo({url:"/pages/login/index?redirect=/pages/user/index"})},V=function(){m("token"),m("userInfo"),g(!1),T({}),U({total:0,pending:0,booked:0,canceled:0}),u({title:"\u5df2\u9000\u51fa\u767b\u5f55",icon:"success"})};return f?i.jsxs(t,{className:"user-page",children:[i.jsxs(t,{className:"profile-card",children:[i.jsx(t,{className:"avatar",children:o(j=(null===S||void 0===S?void 0:S.username)||"U").call(j,0,1).toUpperCase()}),i.jsxs(t,{className:"profile-text",children:[i.jsx(d,{className:"name",children:(null===S||void 0===S?void 0:S.username)||"\u672a\u547d\u540d\u7528\u6237"}),i.jsxs(d,{className:"sub",children:[x[null===S||void 0===S?void 0:S.role]||"\u666e\u901a\u7528\u6237"," \xb7 EasyStay"]})]})]}),i.jsxs(t,{className:"stats-grid",children:[i.jsxs(t,{className:"stat-item",children:[i.jsx(d,{className:"num",children:b?"--":E.total}),i.jsx(d,{className:"label",children:"\u5168\u90e8\u8ba2\u5355"})]}),i.jsxs(t,{className:"stat-item",children:[i.jsx(d,{className:"num",children:b?"--":E.pending}),i.jsx(d,{className:"label",children:"\u5f85\u652f\u4ed8"})]}),i.jsxs(t,{className:"stat-item",children:[i.jsx(d,{className:"num",children:b?"--":E.booked}),i.jsx(d,{className:"label",children:"\u5df2\u9884\u8ba2"})]}),i.jsxs(t,{className:"stat-item",children:[i.jsx(d,{className:"num",children:b?"--":E.canceled}),i.jsx(d,{className:"label",children:"\u5df2\u53d6\u6d88"})]})]}),i.jsxs(t,{className:"action-list",children:[i.jsxs(t,{className:"action-item",onClick:function(){return r.switchTab({url:"/pages/order/index"})},children:[i.jsx(d,{children:"\u6211\u7684\u8ba2\u5355"}),i.jsx(d,{className:"arrow",children:"\u203a"})]}),i.jsxs(t,{className:"action-item",onClick:D,children:[i.jsx(d,{children:"\u5237\u65b0\u6570\u636e"}),i.jsx(d,{className:"arrow",children:"\u203a"})]}),i.jsxs(t,{className:"action-item",onClick:function(){return r.navigateTo({url:"/pages/ai-chat/index"})},children:[i.jsx(d,{children:"AI \u65c5\u884c\u52a9\u624b"}),i.jsx(d,{className:"arrow",children:"\u203a"})]}),i.jsxs(t,{className:"action-item danger",onClick:V,children:[i.jsx(d,{children:"\u9000\u51fa\u767b\u5f55"}),i.jsx(d,{className:"arrow",children:"\u203a"})]})]})]}):i.jsxs(t,{className:"user-page empty-state",children:[i.jsx(d,{className:"title",children:"\u767b\u5f55\u540e\u89e3\u9501\u5b8c\u6574\u670d\u52a1"}),i.jsx(d,{className:"desc",children:"\u67e5\u770b\u8ba2\u5355\u3001\u7ba1\u7406\u652f\u4ed8\u72b6\u6001\u3001\u540c\u6b65\u4e2a\u4eba\u4e2d\u5fc3\u4fe1\u606f"}),i.jsx(t,{className:"primary-btn",onClick:G,children:"\u7acb\u5373\u767b\u5f55"})]})}export{j as default};
