import{t as a,p as e,q as s,A as c,v as n,V as l,T as t,S as i,E as r,x as o,F as d,G as m,Q as u,_ as h,X as f,s as p,J as g,Y as x,m as N,n as j,K as v,z as y,U as k,C}from"./vendors.f0b839a9.js";import{r as b}from"./common.22dc9a71.js";var I=function(){var I,w,D,S=a.useRouter(),F=e.useState(!0),O=s(F,2),A=O[0],M=O[1],T=e.useState(null),J=s(T,2),R=J[0],U=J[1],Y=e.useState([]),E=s(Y,2),X=E[0],_=E[1],q="http://localhost:3000",z=e.useState(!1),B=s(z,2),G=B[0],K=B[1],L=e.useState({checkIn:"",checkOut:"",nightCount:1}),P=s(L,2),Q=P[0],V=P[1],H=function(a,e){var s,c,n=(new Date).getFullYear(),l=h(s=h(c="".concat(n,"/")).call(c,(new Date).getMonth()+1,"/")).call(s,(new Date).getDate()),t=function(a){if(!a||"string"!==typeof a||!v(a).call(a,"\u6708"))return l;try{var e,s,c,t,i,r=y(e=a.replace("\u6708","/").replace("\u65e5","")).call(e),o=r.split("/");if(o.length<2)return l;var d=k(s=o[0]).call(s,2,"0"),m=k(c=o[1]).call(c,2,"0");return h(t=h(i="".concat(n,"/")).call(i,d,"/")).call(t,m)}catch(u){return l}},i=new Date(t(a)),r=new Date(t(e));if(isNaN(i.getTime())||isNaN(r.getTime()))return 1;var o=Math.ceil((r-i)/864e5);return o>0?o:1};e.useEffect(function(){var a=S.params,e=a.id,s=a.checkIn,n=a.checkOut,l=s?decodeURIComponent(s):c().format("M\u6708D\u65e5"),t=n?decodeURIComponent(n):c().add(1,"day").format("M\u6708D\u65e5");V({checkIn:l,checkOut:t,nightCount:H(l,t)}),e&&W(e)},[S.params]);var W=function(){var a=N(j().m(function a(e){var s,c,n,l,t;return j().w(function(a){while(1)switch(a.p=a.n){case 0:return M(!0),a.p=1,a.n=2,b({url:"/hotel/detail/".concat(e)});case 2:return s=a.v,a.n=3,b({url:"/hotel/roomtype/list",data:{hotel_id:e}});case 3:if(c=a.v,200===s.code&&s.data){if(n=s.data,l=[],n.images)try{t="string"===typeof n.images?JSON.parse(n.images):n.images,l=Array.isArray(t)?t:[]}catch(i){l=[]}U(C(C({},n),{},{displayImages:o(l).call(l,function(a){var e;return u(a).call(a,"http")?a:h(e="".concat(q)).call(e,a)}),displayFacilities:n.facilities?"string"===typeof n.facilities?JSON.parse(n.facilities):n.facilities:[]}))}200===c.code&&Array.isArray(c.data)&&_(c.data),a.n=5;break;case 4:a.p=4,a.v,p({title:"\u83b7\u53d6\u8be6\u60c5\u5931\u8d25",icon:"none"});case 5:return a.p=5,M(!1),a.f(5);case 6:return a.a(2)}},a,null,[[1,4,5,6]])}));return function(e){return a.apply(this,arguments)}}(),Z=function(){var e=a.getCurrentPages();e.length>1?a.navigateBack():a.switchTab({url:"/pages/list/index"}).catch(function(){a.reLaunch({url:"/pages/list/index"})})};return A?n.jsx(l,{className:"loading-container",children:n.jsx(t,{children:"\u6b63\u5728\u52a0\u8f7d\u9152\u5e97\u8be6\u60c5..."})}):n.jsxs(l,{className:"detail-page",children:[n.jsxs(l,{className:"custom-nav",children:[n.jsx(l,{className:"back-icon",onClick:Z,children:"\u2190"}),n.jsx(t,{className:"nav-title",children:(null===R||void 0===R?void 0:R.name)||"\u9152\u5e97\u8be6\u60c5"})]}),n.jsxs(i,{scrollY:!0,className:"scroll-content",style:{height:"100vh"},children:[n.jsx(l,{className:"banner-area",children:null!==R&&void 0!==R&&R.displayImages&&R.displayImages.length>0?n.jsx(r,{className:"banner-swiper",circular:!0,indicatorDots:!0,indicatorActiveColor:"#2563eb",children:o(I=R.displayImages).call(I,function(a,e){return n.jsx(d,{children:n.jsx(m,{src:a,mode:"aspectFill",className:"banner-image"})},e)})}):n.jsx(l,{className:"no-img",children:"\u6682\u65e0\u56fe\u7247"})}),n.jsxs(l,{className:"info-card",children:[n.jsx(t,{className:"name",children:null===R||void 0===R?void 0:R.name}),n.jsxs(l,{className:"address-bar",children:["\ud83d\udccd ",null===R||void 0===R?void 0:R.address]}),n.jsx(i,{scrollX:!0,className:"facility-scroll",children:o(w=(null===R||void 0===R?void 0:R.displayFacilities)||[]).call(w,function(a,e){return n.jsx(l,{className:"facility-item",children:n.jsx(t,{className:"f-name",children:"string"===typeof a?a:a.name})},e)})})]}),n.jsx(l,{className:"calendar-bar",onClick:function(){return K(!0)},children:n.jsxs(l,{className:"inner",children:[n.jsx(l,{className:"date-item",children:n.jsx(l,{className:"date",children:Q.checkIn})}),n.jsxs(l,{className:"night-count",children:[Q.nightCount,"\u665a"]}),n.jsx(l,{className:"date-item",children:n.jsx(l,{className:"date",children:Q.checkOut})})]})}),n.jsx(l,{className:"room-list",children:o(D=X||[]).call(D,function(a){var e,s;return n.jsxs(l,{className:"room-card",children:[n.jsx(m,{src:a.image?u(e=a.image).call(e,"http")?a.image:h(s="".concat(q)).call(s,a.image):"",className:"room-img",mode:"aspectFill"}),n.jsxs(l,{className:"room-info",children:[n.jsx(t,{className:"r-name",children:a.name}),n.jsxs(l,{className:"r-bottom",children:[n.jsxs(t,{className:"price",children:["\xa5",f(a.price).toFixed(0)]}),n.jsx(l,{className:"btn-book",onClick:function(){return p({title:"\u9884\u8ba2\u4e2d"})},children:"\u9884\u8ba2"})]})]})]},a.id)})})]}),n.jsx(g,{visible:G,type:"range",onClose:function(){return K(!1)},onConfirm:function(a){var e,s,c=h(e="".concat(x(a[0][1]),"\u6708")).call(e,x(a[0][2]),"\u65e5"),n=h(s="".concat(x(a[1][1]),"\u6708")).call(s,x(a[1][2]),"\u65e5");V({checkIn:c,checkOut:n,nightCount:H(c,n)}),K(!1)}})]})};export{I as default};
