import{v as e,x as a,u as c,V as s,I as l,T as n,A as t,o as r,p as i,t as o,g as d,U as u,F as h,C as m,y as x,S as p,G as v,O as j,_ as N,P as f,s as y,J as g,b as k,K as b,W as w,Q as T}from"./vendors.0de7404b.js";import{r as _}from"./common.5c603857.js";var C=function(o){var d,u=o.data,h=o.onClick,m=e.useState(""),x=a(m,2),p=x[0],v=x[1],j=e.useState(!1),N=a(j,2),f=N[0],y=N[1];return e.useEffect(function(){if(u.aiRecommendation)v(u.aiRecommendation);else{var e=function(){var e=r(i().m(function e(){var a,c;return i().w(function(e){while(1)switch(e.p=e.n){case 0:if(u.name&&u.city){e.n=1;break}return e.a(2);case 1:return y(!0),e.p=2,e.n=3,_({url:"/ai/generate-slogan",method:"POST",data:{hotelName:u.name,city:u.city,tags:u.tags||[]}});case 3:a=e.v,200===a.code&&a.data&&a.data.slogan&&v(a.data.slogan),e.n=5;break;case 4:e.p=4,c=e.v,console.error("\u83b7\u53d6AI\u63a8\u8350\u8bed\u5931\u8d25:",c);case 5:return e.p=5,y(!1),e.f(5);case 6:return e.a(2)}},e,null,[[2,4,5,6]])}));return function(){return e.apply(this,arguments)}}();e()}},[u.id,u.name,u.city,u.tags,u.aiRecommendation]),u?c.jsxs(s,{className:"hotel-card",onClick:h,children:[c.jsxs(s,{className:"hotel-card__media",children:[c.jsx(l,{src:u.imageUrl,className:"hotel-card__img",mode:"aspectFill"}),c.jsx(s,{className:"video-badge",children:c.jsx(n,{className:"icon",children:"\u25b6"})})]}),c.jsxs(s,{className:"hotel-card__content",children:[c.jsxs(s,{children:[c.jsxs(s,{className:"hotel-card__title-row",children:[c.jsx(n,{className:"hotel-card__name",children:u.name}),c.jsx(n,{className:"hotel-card__diamonds",children:" \u25cf\u25cf\u25cf\u25cf\u25cf"})]}),u.score&&c.jsxs(s,{className:"hotel-card__stats",children:[c.jsxs(s,{className:"score-badge",children:[c.jsx(n,{className:"score-num",children:u.score}),c.jsx(n,{className:"score-text",children:u.scoreDesc||"\u597d\u8bc4"})]}),u.commentCount>0&&c.jsxs(n,{className:"comment-text",children:[u.commentCount,"\u70b9\u8bc4",u.collectionCount?" \xb7 ".concat(Math.floor(u.collectionCount/1e4),"\u4e07\u6536\u85cf"):""]})]}),c.jsx(n,{className:"hotel-card__location",children:u.locationDesc}),(p||f)&&c.jsx(s,{className:"hotel-card__highlight",children:c.jsx(n,{className:"highlight-content",children:f?"AI\u6b63\u5728\u751f\u6210\u63a8\u8350\u8bed...":"AI\u63a8\u8350: ".concat(p)})}),c.jsx(s,{className:"hotel-card__tags",children:u.tags&&t(d=u.tags).call(d,function(e,a){return c.jsx(s,{className:"tag-item ".concat(0===a?"tag-blue":""),children:c.jsx(n,{className:"tag-text",children:e})},a)})}),u.ranking&&c.jsxs(s,{className:"hotel-card__ranking",children:[c.jsx(n,{className:"rank-icon",children:"\ud83c\udfc6"}),c.jsx(n,{className:"rank-text",children:u.ranking.text})]})]}),c.jsxs(s,{className:"hotel-card__footer",children:[c.jsx(n,{className:"promo-text",children:"\u94bb\u77f3\u8d35\u5bbe\u4ef7 >"}),c.jsxs(s,{className:"price-box",children:[c.jsx(n,{className:"currency",children:"\xa5"}),c.jsx(n,{className:"price",children:u.price}),c.jsx(n,{className:"suffix",children:"\u8d77"})]})]})]})]}):null};const S=C;var D="http://1.14.207.212:8848",I=[{label:"\u4e0d\u9650",value:"all"},{label:"\xa50-150",value:"0-150"},{label:"\xa5150-300",value:"150-300"},{label:"\xa5300-600",value:"300-600"},{label:"\xa5600+",value:"600-up"}],O=[{label:"\u4e0d\u9650",value:"all"},{label:"\u4e8c\u661f/\u7ecf\u6d4e",value:"2"},{label:"\u4e09\u661f/\u8212\u9002",value:"3"},{label:"\u56db\u661f/\u9ad8\u6863",value:"4"},{label:"\u4e94\u661f/\u8c6a\u534e",value:"5"}];function A(){var l,C=e.useState([]),A=a(C,2),M=A[0],R=A[1],P=e.useState(!1),U=a(P,2),$=U[0],B=U[1],E=e.useState(1),F=a(E,2),G=F[0],J=F[1],L=e.useState(!0),W=a(L,2),Y=W[0],q=W[1],z=e.useState({city:"",checkInDate:"",checkOutDate:"",keyword:"",priceType:"all",starType:"all"}),H=a(z,2),K=H[0],Q=H[1],V=e.useState(!1),X=a(V,2),Z=X[0],ee=X[1],ae=e.useState({price:"all",star:"all"}),ce=a(ae,2),se=ce[0],le=ce[1],ne=e.useState(!1),te=a(ne,2),re=te[0],ie=te[1],oe=function(e){var a={"0-150":{min:0,max:150},"150-300":{min:150,max:300},"300-600":{min:300,max:600},"600-up":{min:600,max:99999}};return a[e]||{min:void 0,max:void 0}},de=e.useRef(!1),ue=e.useRef("");o.useLoad(function(){console.log("\u5217\u8868\u9875\u52a0\u8f7d\uff08\u4ec5\u5728\u9875\u9762\u9500\u6bc1\u540e\u91cd\u65b0\u8fdb\u5165\u65f6\u89e6\u53d1\uff09")}),o.useDidShow(function(){console.log("\u5217\u8868\u9875\u663e\u793a\uff08\u6bcf\u6b21\u5207\u56de\u6216\u8fdb\u5165\u8be5\u9875\u90fd\u4f1a\u89e6\u53d1\uff09");var e=d("hotelSearchParams")||{},a=u(e);(!de.current||a&&a!==ue.current)&&(de.current=!0,ue.current=a,he(e))});var he=function(e){var a,c=e||d("hotelSearchParams")||{};console.log("\u3010\u68c0\u6d4b\u7f13\u5b58\u540c\u6b65\u3011:",c);var s=h(a=String(c.city||"").replace(/\u5e02$/,"")).call(a),l={city:s,checkInDate:(null===c||void 0===c?void 0:c.checkInDate)||"",checkOutDate:(null===c||void 0===c?void 0:c.checkOutDate)||"",keyword:(null===c||void 0===c?void 0:c.keyword)||"",priceType:(null===c||void 0===c?void 0:c.priceType)||"all",starType:(null===c||void 0===c?void 0:c.starType)||"all"};Q(l),le({price:l.priceType,star:l.starType}),Ce([]),q(!0),J(1),R([]),me(l,1,Pe,[])},me=function(){var e=r(i().m(function e(a){var c,s,l,n,r,o,d,u,m,p,j,f,w,C,S,I,O,A,M,P,U,E,F,G,J,L,W=arguments;return i().w(function(e){while(1)switch(e.p=e.n){case 0:if(d=W.length>1&&void 0!==W[1]?W[1]:1,u=W.length>2&&void 0!==W[2]?W[2]:Pe,m=W.length>3&&void 0!==W[3]?W[3]:_e,p=W.length>4&&void 0!==W[4]&&W[4],!$){e.n=1;break}return e.a(2);case 1:return B(!0),j=oe(a.priceType),f=j.min,w=j.max,C=t(c=g(s=m||[]).call(s,function(e){return"\u4e94\u661f\u7ea7"!==e})).call(c,function(e){return be[e]||e}),S=g(l=N(n=[a.keyword]).call(n,b(C))).call(l,Boolean).join(" "),I={page:d,limit:10},a.city&&!p&&(I.city=h(r=String(a.city).replace(/\u5e02$/,"")).call(r)),S&&(I.keyword=S),a.starType&&"all"!==a.starType&&(I.star=a.starType),a.starType&&"all"!==a.starType||!v(o=m||[]).call(o,"\u4e94\u661f\u7ea7")||(I.star="5"),void 0!==f&&(I.min_price=f),void 0!==w&&(I.max_price=w),"price_low"===u&&(I.sort="price_asc"),"rating"===u&&(I.sort="price_desc"),e.p=2,e.n=3,_({url:"/hotel/list",method:"GET",data:I});case 3:if(O=e.v,200!==O.code){e.n=5;break}if(A=O.data,M=A.list,P=A.total,1!==d||0!==P||!a.city||p){e.n=4;break}return B(!1),ie(!0),e.a(2,me(a,1,u,m,!0));case 4:1!==d||p||ie(!1),U=t(M).call(M,function(e){var a,c,s=e.tags||[];if("string"===typeof e.tags)try{s=JSON.parse(e.tags)}catch(n){var l;s=g(l=e.tags.split(/[\u3001,|/ ]+/)).call(l,Boolean)}return x(x({},e),{},{imageUrl:null!==(a=e.cover_image)&&void 0!==a&&k(a).call(a,"http")?e.cover_image:N(c="".concat(D)).call(c,e.cover_image),tags:s,locationDesc:e.address,score:e.score})}),"rating"===u&&(U=T(E=b(U)).call(E,function(e,a){return Number(a.score||0)-Number(e.score||0)})),"distance"===u&&a.city&&(J=h(F=String(a.city).replace(/\u5e02$/,"")).call(F),U=T(G=b(U)).call(G,function(e,a){var c,s,l=v(c=String(e.city||"")).call(c,J)?0:1,n=v(s=String(a.city||"")).call(s,J)?0:1;return l-n})),R(1===d?U:function(e){var a;return N(a=[]).call(a,b(e),b(U))}),q(10*(d-1)+M.length<P);case 5:e.n=7;break;case 6:e.p=6,L=e.v,console.error("\u5217\u8868\u52a0\u8f7d\u5931\u8d25:",L),y({title:"\u52a0\u8f7d\u5931\u8d25",icon:"none"});case 7:return e.p=7,B(!1),e.f(7);case 8:return e.a(2)}},e,null,[[2,6,7,8]])}));return function(a){return e.apply(this,arguments)}}(),xe=function(){if(console.log("--- \u89e6\u5e95\u4e8b\u4ef6\u6210\u529f\u89e6\u53d1 ---"),$)console.log("\u5f53\u524d\u6b63\u5728\u52a0\u8f7d\uff0c\u62e6\u622a\u8bf7\u6c42");else if(Y){var e=G+1;J(e),me(K,e,Pe,_e,re)}else console.log("\u6ca1\u6709\u66f4\u591a\u6570\u636e\uff0c\u62e6\u622a\u8bf7\u6c42")},pe=function(e){var a=x(x({},K),{},{keyword:h(e).call(e)});Q(a),J(1),R([]),me(a,1,Pe,_e)},ve=function(){var e=x(x({},K),{},{priceType:se.price,starType:se.star});Q(e),J(1),R([]),ee(!1),me(e,1,Pe,_e)},je=function(e){Ue(e),Ae(""),J(1),me(K,1,e,_e)},Ne=function(){console.log("\u8fd4\u56de\u5230\u9152\u5e97\u641c\u7d22\u9996\u9875"),o.switchTab({url:"/pages/index/index",success:function(){console.log("\u6210\u529f\u8fd4\u56de\u5230\u9996\u9875")},fail:function(e){console.error("\u8fd4\u56de\u5931\u8d25:",e),y({title:"\u8fd4\u56de\u5931\u8d25",icon:"error"})}})},fe=function(e){var a=j(I).call(I,function(a){return a.value===e});return a?a.label:"\u4e0d\u9650"},ye=function(e){var a=j(O).call(O,function(a){return a.value===e});return a?a.label:"\u4e0d\u9650"},ge=function(e){var a,c=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"MM-DD";if(!e)return"";var s,l,n,t=h(a=e.replace("\u6708","-").replace("\u65e5","")).call(a),r=t.split("-"),i="",o="";return r.length>=2?(i=w(s=r[r.length-2]).call(s,2,"0"),o=w(l=r[r.length-1]).call(l,2,"0"),"MM-DD"===c?N(n="".concat(i,"-")).call(n,o):t):e},ke=["\u53cc\u5e8a\u623f","\u542b\u65e9\u9910","\u514d\u8d39\u53d6\u6d88","\u4eb2\u5b50\u4f18\u9009","\u667a\u80fd\u5bb6\u5c45","\u6c5f\u666f\u623f","\u5730\u94c1\u5468\u8fb9","\u4e94\u661f\u7ea7","\u6cf3\u6c60"],be={"\u53cc\u5e8a\u623f":"\u53cc\u5e8a","\u542b\u65e9\u9910":"\u65e9\u9910","\u514d\u8d39\u53d6\u6d88":"\u514d\u8d39\u53d6\u6d88","\u4eb2\u5b50\u4f18\u9009":"\u4eb2\u5b50","\u667a\u80fd\u5bb6\u5c45":"\u667a\u80fd","\u6c5f\u666f\u623f":"\u6c5f\u666f","\u5730\u94c1\u5468\u8fb9":"\u5730\u94c1","\u6cf3\u6c60":"\u6cf3\u6c60"},we=e.useState([]),Te=a(we,2),_e=Te[0],Ce=Te[1],Se=function(e){var a=[];Ce(function(c){var s;return a=v(c).call(c,e)?g(c).call(c,function(a){return a!==e}):N(s=[]).call(s,b(c),[e]),a});var c=x(x({},K),{},{starType:v(a).call(a,"\u4e94\u661f\u7ea7")?"5":"5"===K.starType?"all":K.starType});Q(c),J(1),R([]),me(c,1,Pe,a)},De=e.useState(""),Ie=a(De,2),Oe=Ie[0],Ae=Ie[1],Me=e.useState("welcome"),Re=a(Me,2),Pe=Re[0],Ue=Re[1],$e=[{label:"\u6b22\u8fce\u5ea6\u6392\u5e8f",value:"welcome"},{label:"\u597d\u8bc4\u4f18\u5148",value:"rating"},{label:"\u4f4e\u4ef7\u4f18\u5148",value:"price_low"}],Be=function(e){"distance"!==e?Ae(Oe===e?"":e):je("distance")};return c.jsxs(s,{className:"list-page",children:[c.jsxs(s,{className:"sticky-header",children:[c.jsx(s,{className:"search-bar",children:c.jsx(s,{className:"search-capsule-container",children:c.jsxs(s,{className:"search-capsule",children:[c.jsx(s,{className:"back-btn",onClick:Ne,children:c.jsx(n,{className:"back-icon",children:"\u2b05"})}),c.jsxs(s,{className:"capsule-section city-section",children:[c.jsx(n,{className:"city-name",children:K.city||"\u4e0d\u9650\u57ce\u5e02"}),c.jsx(s,{className:"section-divider"})]}),c.jsxs(s,{className:"capsule-section date-section",children:[c.jsxs(s,{className:"date-content",children:[c.jsxs(s,{className:"date-container",children:[c.jsx(n,{className:"date-label",children:"\u4f4f"}),c.jsx(n,{className:"date-value",children:ge(K.checkInDate)||"--"})]}),c.jsxs(s,{className:"date-container",children:[c.jsx(n,{className:"date-label",children:"\u79bb"}),c.jsx(n,{className:"date-value",children:ge(K.checkOutDate)||"--"})]})]}),c.jsx(s,{className:"section-divider right-vertical-line"})]}),c.jsxs(s,{className:"capsule-section keyword-section",children:[c.jsx(n,{className:"search-prefix-icon",children:"\ue8b6"}),c.jsx(m,{className:"keyword-input",placeholder:"\u57ce\u5e02/\u4f4d\u7f6e/\u54c1\u724c/\u9152\u5e97\u540d",placeholderClass:"keyword-placeholder",value:K.keyword,onInput:function(e){return Q(function(a){return x(x({},a),{},{keyword:e.detail.value})})},onConfirm:function(e){return pe(e.detail.value)},confirmType:"search"}),K.keyword?c.jsx(s,{className:"keyword-clear",onClick:function(){return pe("")},children:c.jsx(n,{children:"\xd7"})}):null]}),c.jsx(s,{className:"search-icon-section",onClick:function(){return pe(K.keyword)},children:c.jsx(n,{className:"search-icon",children:"\u641c\u7d22"})})]})})}),c.jsx(p,{className:"quick-filter-tags",scrollX:!0,showsHorizontalScrollIndicator:!1,enhanced:!0,scrollWithAnimation:!0,children:c.jsx(s,{className:"tags-container",children:t(ke).call(ke,function(e){return c.jsx(s,{className:"filter-tag ".concat(v(_e).call(_e,e)?"active":""),hoverClass:"filter-tag--hover",hoverStayTime:80,onClick:function(){return Se(e)},children:c.jsx(n,{className:"tag-text",children:e})},e)})})}),c.jsxs(s,{className:"sort-bar",children:[c.jsxs(s,{className:"sort-item ".concat("welcome"===Pe||"welcome"===Oe?"active":""),hoverClass:"sort-item--hover",onClick:function(){return Be("welcome")},children:[c.jsx(n,{className:"sort-text",children:(null===(l=j($e).call($e,function(e){return e.value===Pe}))||void 0===l?void 0:l.label)||"\u6b22\u8fce\u5ea6"}),c.jsx(s,{className:"sort-icon",children:"\u25bc"})]}),c.jsxs(s,{className:"sort-item ".concat("distance"===Pe?"active":""),hoverClass:"sort-item--hover",onClick:function(){return Be("distance")},children:[c.jsx(n,{className:"sort-text",children:"\u4f4d\u7f6e\u8ddd\u79bb"}),c.jsx(s,{className:"sort-icon",children:"\u25bc"})]}),c.jsxs(s,{className:"sort-item ".concat("all"!==K.priceType||"all"!==K.starType?"active":""),hoverClass:"sort-item--hover",onClick:function(){return ee(!0)},children:[c.jsx(n,{className:"sort-text",children:"\u4ef7\u683c/\u661f\u7ea7"}),c.jsx(s,{className:"sort-icon",children:"\u25bc"}),("all"!==K.priceType||"all"!==K.starType)&&c.jsx(s,{className:"filter-indicator"})]}),c.jsxs(s,{className:"sort-item",hoverClass:"sort-item--hover",children:[c.jsx(n,{className:"sort-text",children:"\u7b5b\u9009"}),c.jsx(s,{className:"sort-icon",children:"\u2261"})]})]}),(K.city||K.keyword||"all"!==K.priceType||"all"!==K.starType)&&c.jsx(s,{className:"filter-summary",children:c.jsxs(n,{className:"summary-text",children:["\u5f53\u524d\u7b5b\u9009:",K.city&&!re&&" \u57ce\u5e02:".concat(K.city),K.keyword&&' "'.concat(K.keyword,'"'),"all"!==K.priceType&&" \u4ef7\u683c:".concat(fe(K.priceType)),"all"!==K.starType&&" \u661f\u7ea7:".concat(ye(K.starType))]})})]}),c.jsx(p,{scrollY:!0,className:"list-scroll",onScrollToLower:xe,lowerThreshold:200,enhanced:!0,children:c.jsxs(s,{className:"list-content",children:[re&&K.city&&c.jsx(s,{className:"fallback-notice",children:c.jsx(n,{children:"\u5f53\u524d\u4f4d\u7f6e\u6682\u65e0\u9152\u5e97\uff0c\u4e3a\u60a8\u63a8\u8350\u4ee5\u4e0b\u70ed\u95e8\u9152\u5e97"})}),t(M).call(M,function(e){return c.jsx(S,{data:e,onClick:function(){var a,c;o.navigateTo({url:N(a=N(c="/pages/detail/index?id=".concat(e.id,"&checkIn=")).call(c,K.checkInDate,"&checkOut=")).call(a,K.checkOutDate)})}},e.id)}),c.jsx(s,{className:"loading-status-bar",children:$?c.jsx(n,{className:"status-loading",children:"\u6b63\u5728\u52aa\u529b\u52a0\u8f7d\u4e2d..."}):Y?c.jsx(n,{className:"status-loading",children:"\u4e0a\u6ed1\u52a0\u8f7d\u66f4\u591a"}):c.jsxs(s,{className:"no-more-container",children:[c.jsx(s,{className:"divider-line"}),c.jsx(n,{className:"no-more-text",children:"\u5df2\u7ecf\u5230\u5e95\u5566"}),c.jsx(s,{className:"divider-line"}),!re&&K.city&&c.jsx(s,{className:"show-all-btn",onClick:function(){var e=x(x({},K),{},{city:""});Q(e),J(1),R([]),me(e,1,Pe,_e)},children:c.jsx(n,{children:"\u67e5\u770b\u6240\u6709\u57ce\u5e02\u9152\u5e97"})})]})})]})}),c.jsx(f,{visible:"welcome"===Oe,position:"top",onClose:function(){return Ae("")},style:{top:"100px"},children:c.jsx(s,{className:"sort-dropdown",children:t($e).call($e,function(e){return c.jsx(s,{className:"dropdown-item ".concat(Pe===e.value?"active":""),onClick:function(){return je(e.value)},children:e.label},e.value)})})}),c.jsx(f,{visible:Z,position:"bottom",round:!0,onClose:function(){return ee(!1)},children:c.jsxs(s,{className:"filter-popup",children:[c.jsxs(s,{className:"popup-header",children:[c.jsx(n,{className:"title",children:"\u4ef7\u683c/\u661f\u7ea7\u7b5b\u9009"}),c.jsx(n,{className:"close",onClick:function(){return ee(!1)},children:"\u2715"})]}),c.jsxs(p,{scrollY:!0,className:"popup-body",children:[c.jsxs(s,{className:"section",children:[c.jsx(n,{className:"section-title",children:"\u4ef7\u683c\u9884\u7b97"}),c.jsx(s,{className:"tags-grid",children:t(I).call(I,function(e){return c.jsx(s,{className:"tag ".concat(se.price===e.value?"active":""),onClick:function(){return le(function(a){return x(x({},a),{},{price:e.value})})},children:e.label},e.value)})})]}),c.jsxs(s,{className:"section",children:[c.jsx(n,{className:"section-title",children:"\u661f\u7ea7\u6807\u51c6"}),c.jsx(s,{className:"tags-grid",children:t(O).call(O,function(e){return c.jsx(s,{className:"tag ".concat(se.star===e.value?"active":""),onClick:function(){return le(function(a){return x(x({},a),{},{star:e.value})})},children:e.label},e.value)})})]})]}),c.jsxs(s,{className:"popup-footer",children:[c.jsx(s,{className:"btn reset",onClick:function(){return le({price:"all",star:"all"})},children:"\u91cd\u7f6e"}),c.jsx(s,{className:"btn confirm",onClick:ve,children:"\u67e5\u770b\u9152\u5e97"})]})]})})]})}export{A as default};
