import{t as a,p as e,q as s,A as c,v as l,V as n,T as t,S as i,D as r,x as o,E as d,F as m,W as h,O as u,_ as f,N as x,s as p,H as g,X as N,m as j,n as v,J as y,z as k,U as b,C}from"./vendors.576a9c55.js";import{r as I}from"./common.41365892.js";var w=function(){var w,D,F,O,S=a.useRouter(),A=e.useState(!0),M=s(A,2),T=M[0],J=M[1],R=e.useState(null),U=s(R,2),E=U[0],X=U[1],Y=e.useState([]),_=s(Y,2),q=_[0],z=_[1],B="http://localhost:3000",H=e.useState(!1),L=s(H,2),P=L[0],V=L[1],W=e.useState({checkIn:"",checkOut:"",nightCount:1}),G=s(W,2),K=G[0],Q=G[1],Z=function(a,e){var s,c,l=(new Date).getFullYear(),n=f(s=f(c="".concat(l,"/")).call(c,(new Date).getMonth()+1,"/")).call(s,(new Date).getDate()),t=function(a){if(!a||"string"!==typeof a||!y(a).call(a,"\u6708"))return n;try{var e,s,c,t,i,r=k(e=a.replace("\u6708","/").replace("\u65e5","")).call(e),o=r.split("/");if(o.length<2)return n;var d=b(s=o[0]).call(s,2,"0"),m=b(c=o[1]).call(c,2,"0");return f(t=f(i="".concat(l,"/")).call(i,d,"/")).call(t,m)}catch(h){return n}},i=new Date(t(a)),r=new Date(t(e));if(isNaN(i.getTime())||isNaN(r.getTime()))return 1;var o=Math.ceil((r-i)/864e5);return o>0?o:1};e.useEffect(function(){var a=S.params,e=a.id,s=a.checkIn,l=a.checkOut,n=s?decodeURIComponent(s):c().format("M\u6708D\u65e5"),t=l?decodeURIComponent(l):c().add(1,"day").format("M\u6708D\u65e5");Q({checkIn:n,checkOut:t,nightCount:Z(n,t)}),e&&$(e)},[S.params]);var $=function(){var a=j(v().m(function a(e){var s,c,l,n,t;return v().w(function(a){while(1)switch(a.p=a.n){case 0:return J(!0),a.p=1,a.n=2,I({url:"/hotel/detail/".concat(e)});case 2:return s=a.v,a.n=3,I({url:"/hotel/roomtype/list",data:{hotel_id:e}});case 3:if(c=a.v,200===s.code&&s.data){if(l=s.data,n=[],l.images)try{t="string"===typeof l.images?JSON.parse(l.images):l.images,n=Array.isArray(t)?t:[]}catch(i){n=[]}X(C(C({},l),{},{displayImages:o(n).call(n,function(a){var e;return u(a).call(a,"http")?a:f(e="".concat(B)).call(e,a)}),displayFacilities:l.facilities?"string"===typeof l.facilities?JSON.parse(l.facilities):l.facilities:[]}))}200===c.code&&Array.isArray(c.data)&&z(c.data),a.n=5;break;case 4:a.p=4,a.v,p({title:"\u83b7\u53d6\u8be6\u60c5\u5931\u8d25",icon:"none"});case 5:return a.p=5,J(!1),a.f(5);case 6:return a.a(2)}},a,null,[[1,4,5,6]])}));return function(e){return a.apply(this,arguments)}}(),aa=function(){var e=a.getCurrentPages();e.length>1?a.navigateBack():a.switchTab({url:"/pages/list/index"}).catch(function(){a.reLaunch({url:"/pages/list/index"})})};return T?l.jsx(n,{className:"loading-container",children:l.jsx(t,{children:"\u6b63\u5728\u52a0\u8f7d\u9152\u5e97\u8be6\u60c5..."})}):l.jsxs(n,{className:"detail-page",children:[l.jsxs(n,{className:"custom-nav",children:[l.jsx(n,{className:"back-icon",onClick:aa,children:"\u2190"}),l.jsx(t,{className:"nav-title",children:(null===E||void 0===E?void 0:E.name)||"\u9152\u5e97\u8be6\u60c5"})]}),l.jsxs(i,{scrollY:!0,className:"scroll-content",style:{height:"100vh"},children:[l.jsx(n,{className:"banner-area",children:null!==E&&void 0!==E&&E.displayImages&&E.displayImages.length>0?l.jsx(r,{className:"banner-swiper",circular:!0,indicatorDots:!0,indicatorActiveColor:"#2563eb",children:o(w=E.displayImages).call(w,function(a,e){return l.jsx(d,{children:l.jsx(m,{src:a,mode:"aspectFill",className:"banner-image"})},e)})}):l.jsx(n,{className:"no-img",children:"\u6682\u65e0\u56fe\u7247"})}),l.jsxs(n,{className:"info-card",children:[l.jsx(t,{className:"name",children:null===E||void 0===E?void 0:E.name}),(null===E||void 0===E?void 0:E.star)&&l.jsxs(n,{className:"star-bar",children:[l.jsx(t,{className:"star-text",children:h(D="\u2605").call(D,E.star)}),l.jsxs(t,{className:"star-label",children:[E.star,"\u661f\u7ea7\u9152\u5e97"]})]}),l.jsxs(n,{className:"address-bar",children:["\u4f4d\u7f6e: ",null===E||void 0===E?void 0:E.address]}),(null===E||void 0===E?void 0:E.displayFacilities)&&E.displayFacilities.length>0&&l.jsxs(l.Fragment,{children:[l.jsx(n,{className:"section-title",children:"\u9152\u5e97\u8bbe\u65bd"}),l.jsx(i,{scrollX:!0,className:"facility-scroll",children:o(F=E.displayFacilities).call(F,function(a,e){return l.jsx(n,{className:"facility-item",children:l.jsx(t,{className:"f-name",children:"string"===typeof a?a:a.name})},e)})})]})]}),l.jsx(n,{className:"calendar-bar",onClick:function(){return V(!0)},children:l.jsxs(n,{className:"inner",children:[l.jsx(n,{className:"date-item",children:l.jsx(n,{className:"date",children:K.checkIn})}),l.jsxs(n,{className:"night-count",children:[K.nightCount,"\u665a"]}),l.jsx(n,{className:"date-item",children:l.jsx(n,{className:"date",children:K.checkOut})})]})}),l.jsx(n,{className:"room-list",children:o(O=q||[]).call(O,function(a){var e,s;return l.jsxs(n,{className:"room-card",children:[l.jsx(m,{src:a.image?u(e=a.image).call(e,"http")?a.image:f(s="".concat(B)).call(s,a.image):"",className:"room-img",mode:"aspectFill"}),l.jsxs(n,{className:"room-info",children:[l.jsx(t,{className:"r-name",children:a.name}),l.jsxs(n,{className:"r-bottom",children:[l.jsxs(t,{className:"price",children:["\xa5",x(a.price).toFixed(0)]}),l.jsx(n,{className:"btn-book",onClick:function(){return p({title:"\u9884\u8ba2\u4e2d"})},children:"\u9884\u8ba2"})]})]})]},a.id)})})]}),l.jsx(g,{visible:P,type:"range",onClose:function(){return V(!1)},onConfirm:function(a){var e,s,c=f(e="".concat(N(a[0][1]),"\u6708")).call(e,N(a[0][2]),"\u65e5"),l=f(s="".concat(N(a[1][1]),"\u6708")).call(s,N(a[1][2]),"\u65e5");Q({checkIn:c,checkOut:l,nightCount:Z(c,l)}),V(!1)}})]})};export{w as default};
