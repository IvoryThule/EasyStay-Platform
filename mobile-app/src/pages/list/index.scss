/* [页面样式] 列表页 */
/* 待实现。 */
// pages/list/index.scss
$primary: #2563eb;
$primary-light: rgba(37, 99, 235, 0.1);
$success: #10b981;
$warning: #f59e0b;
$bg-gray: #f5f6fa;
$border-color: #e5e7eb;
$text-primary: #111827;
$text-secondary: #6b7280;

.list-page {
  height: 100vh;
  background: #fff;
  display: flex;        // 新增：变为 Flex 容器
  flex-direction: column; // 新增：垂直排列
  overflow: hidden;
}

// ==================== 顶部sticky区域 ====================
.sticky-header {
  flex-shrink: 0;
  background: #fff;
  z-index: 1000;
  box-shadow: 0 1px 3px rgba(0, 0, 0, 0.08);
}

.list-scroll {
  flex: 1;                 // 【核心】占据页面剩下的所有高度
  min-height: 0;           // 【必填】修复 Flex 内部滚动溢出的经典 Bug
  width: 100%;
  overflow-y: scroll;      // 确保纵向滚动开启
  background: #fff;
  min-height: 0;
  
  // 不要在这里写 height: 100vh，否则它会超出屏幕
}

// ==================== 1. 搜索胶囊区域 ====================
// 整体设计参考HTML代码
.search-bar {
  padding: 12px 16px 10px;
  background: #fff;
  
  .search-capsule-container {
    background: rgba(243, 244, 246, 0.8);
    border-radius: 9999px;
    padding: 8px 12px;
    backdrop-filter: blur(10px);
    border: 1px solid rgba(229, 231, 235, 0.5);
    
    .search-capsule {
      display: flex;
      align-items: center;
      justify-content: space-between;
      height: 40px;
      
      // 返回按钮
      .back-btn {
        width: 28px;
        height: 28px;
        display: flex;
        align-items: center;
        justify-content: center;
        margin-right: 8px;
        
        .back-icon {
          font-size: 24px;
          color: #6b7280;
          font-weight: bold;
          line-height: 1;
        }
      }
      
      // 胶囊内的每个部分
      .capsule-section {
        display: flex;
        align-items: center;
        height: 100%;
        
        // 城市部分 - 直接加粗显示城市名
        &.city-section {
          .city-name {
            font-size: 24px;
            font-weight: 700; // 加粗
            color: #2563eb; // 蓝色
            line-height: 1;
            white-space: nowrap;
          }
          
          .section-divider {
            width: 1px;
            height: 22px;
            background: #d1d5db;
            margin: 0 12px;
          }
        }
        
        // 日期部分 - 上下结构
        &.date-section {
        // 核心修改1：容器改为垂直布局
            display: flex;
            flex-direction: row;
            align-items: center; 
            gap: 0; 
        
        .date-content {
            display: flex;
            flex-direction: column;
            align-items: flex-start;
            gap: 4px; // 住/离之间的间距，可根据需要调整
        }
        
        .date-container {
            display: flex;
            // 核心修改2：单行改为横向排列（住/离 与 日期并排）
            flex-direction: row;
            align-items: center; // 垂直居中对齐
            // 移除原有：margin-right: 8px;（上下布局不需要横向间距）
            margin: 0; // 重置外边距
    
        .date-label {
            // 保留你原有样式，仅新增横向间距
            font-size: 16px;
            color: #6b7280;
            font-weight: 500;
            line-height: 1.2;
            // 移除原有：margin-bottom: 1px;（横向布局不需要上下间距）
            margin-right: 4px; // 新增：标签与日期之间的横向间距
        }
    
        .date-value {
        // 完全保留你原有样式
            font-size: 16px;
            color: #6b7280;
            font-weight: 500;
            line-height: 1.2;
        }
    }
  
        .right-vertical-line {
            width: 1px;
            height: 22px;
            background: #d1d5db;
            margin: 0 12px; // 你指定的左右12px间距
        }
      }
        
        // 关键词部分
        &.keyword-section {
          flex: 1;
          min-width: 0;
          display: flex;
          align-items: center;
          gap: 4px;

          .search-prefix-icon {
            font-size: 18px;
            color: #9ca3af;
            flex-shrink: 0;
          }

          .keyword-input {
            flex: 1;
            font-size: 20px;
            color: #1f2937;
            line-height: 1.2;
            height: 36px;
            min-width: 0;
          }

          .keyword-placeholder {
            font-size: 20px;
            color: #9ca3af;
            font-weight: 400;
          }

          .keyword-clear {
            width: 28px;
            height: 28px;
            background: #d1d5db;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            flex-shrink: 0;
            font-size: 18px;
            color: #fff;
          }
        }
      }
      
      // 搜索图标部分
      .search-icon-section {
        margin-left: 8px;
        
        .search-icon {
          font-size: 18px;
          color: #555a61;
          line-height: 1;
        }
      }
    }
  }
}


// 快速筛选标签
.quick-filter-tags {
  padding: 0 16px 12px;
  background: #fff;
  
  .tags-container {
    display: flex;
    gap: 8px;
    padding: 8px 0; // 增加上下内边距，给放大后的字体留空间
    overflow-x: auto; // 确保可以横向滚动
    
    .filter-tag {
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 10px 20px; // 适当增加 padding
      background: #f3f4f6;
      border-radius: 40px; // 随高度变大增加圆角
      border: 1px solid transparent;
      flex-shrink: 0;
      min-height: 40px; // 增加最小高度确保容器不塌陷
      // 增加过渡动画，让缩放和变色更平滑
      transition: all 0.1s ease-out; 

      // --- 【新增：点击瞬间的动效】 ---
      &--hover {
        background-color: #e5e7eb !important; // 背景变深
        transform: scale(0.94); // 按钮轻微缩小，产生按压感
        opacity: 0.8; // 轻微透明
      }
      
      &.active {
        background: rgba($primary, 0.1); // 假设 $primary 已定义
        border-color: $primary;
      }

      // 选中状态下的点击动效
        &--hover {
          background-color: rgba($primary, 0.2) !important;
        }
        .tag-text {
          color: $primary;
          font-weight: 600;
        }
      
      // 使用更具体的选择器确保权重
      .tag-text {
        display: inline-block;
        font-size: 22px !important; // !important 解决权重
        color: #374151;
        font-weight: 500;
        line-height: 1.4; // 确保行高正常
        
        // 选中状态下的文字
        .active & {
          color: $primary;
          font-weight: 600;
          font-size: 32rpx !important; 
        }
      }
    }
  }
}

// ==================== 3. 排序栏 ====================
.sort-bar {
  display: flex;
  justify-content: space-around;
  align-items: center;
  padding: 12px 0;
  background: #fff;
  border-bottom: 1px solid $border-color;
  position: sticky; // 吸顶效果（可选）
  top: 0;
  z-index: 100;
  
  .sort-item {
    display: flex;
    align-items: center;
    padding: 8px 10px;
    position: relative;
    border-radius: 8px;
    transition: all 0.1s ease;

    // 原生点击反馈类名
    &--hover {
      background: #f5f5f5 !important;
      transform: scale(0.95); // 点击轻微缩小
    }
    
    // 激活状态
    &.active {
      .sort-text {
        color: $primary;
        font-weight: 700;
      }
      .sort-icon {
        color: $primary;
        transform: rotate(180deg); // 激活时图标反转
      }
    }
    
    .sort-text {
      font-size: 25px !important; // 放大至 34rpx (约 17px)
      color: #333;
      font-weight: 600;
      margin-right: 4px;
      line-height: 1.2;
    }
    
    .sort-icon {
      font-size: 24rpx;
      color: #999;
      transition: transform 0.2s ease;
    }
    
    .filter-indicator {
      position: absolute;
      top: 4px;
      right: 2px;
      width: 12rpx;
      height: 12rpx;
      background: $primary;
      border-radius: 50%;
    }
  }
}

// 下拉弹窗样式简述
.sort-dropdown {
  background: #fff;
  padding: 20px;
  .dropdown-item {
    padding: 30rpx 0;
    font-size: 32rpx;
    border-bottom: 1rpx solid #f2f2f2;
    &.active { color: $primary; font-weight: bold; }
  }
}


// ==================== 地图按钮 ====================
.map-button {
  position: absolute;
  right: 20px;
  bottom: 100px;
  width: 56px;
  height: 56px;
  background: #fff;
  border-radius: 28px;
  box-shadow: 0 4px 12px rgba(0,0,0,0.15);
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  z-index: 50;
  
  .map-icon {
    font-size: 20px;
    color: $primary;
    margin-bottom: 2px;
  }
  
  .map-text {
    font-size: 10px;
    color: $primary;
    font-weight: bold;
  }
}

// ==================== 筛选弹窗 ====================
.filter-popup {
  background: #fff;
  height: 60vh;
  display: flex;
  flex-direction: column;

  .popup-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 20px;
    border-bottom: 1px solid $border-color;
    
    .title {
      font-size: 18px;
      font-weight: bold;
      color: #111827;
    }
    
    .close {
      font-size: 20px;
      color: #6b7280;
      padding: 4px;
    }
  }

  .popup-body {
    flex: 1;
    padding: 20px;
    overflow-y: auto;

    .section {
      margin-bottom: 28px;
      
      .section-title {
        font-size: 16px;
        font-weight: bold;
        color: #111827;
        display: block;
        margin-bottom: 16px;
      }

      .tags-grid {
        display: flex;
        flex-wrap: wrap;
        gap: 12px;

        .tag {
          padding: 12px 20px;
          background: #f3f4f6;
          border-radius: 20px;
          font-size: 14px;
          color: #374151;
          border: 1px solid transparent;
          transition: all 0.2s ease;
          min-width: 90px;
          text-align: center;
          font-weight: 500;

          &.active {
            background: $primary-light;
            color: $primary;
            font-weight: 600;
            border-color: $primary;
          }
        }
      }
    }
  }

  .popup-footer {
    display: flex;
    padding: 20px;
    border-top: 1px solid $border-color;
    gap: 12px;

    .btn {
      flex: 1;
      height: 48px;
      display: flex;
      align-items: center;
      justify-content: center;
      border-radius: 24px;
      font-size: 16px;
      font-weight: 600;
      transition: all 0.2s ease;
      
      &.reset {
        background: #fff;
        border: 1px solid #d1d5db;
        color: #374151;
        
        &:active {
          background: #f9fafb;
        }
      }

      &.confirm {
        background: $primary;
        color: #fff;
        border: 1px solid $primary;
        
        &:active {
          background: scale-color($primary, $lightness: -10%);
        }
      }
    }
  }
}

// ==================== 4. 筛选条件摘要 ====================
.filter-summary {
  padding: 10px 16px;
  background: #f8fafc;
  border-top: 1px solid #e5e7eb;
  
  .summary-text {
    font-size: 14px;
    color: $text-secondary;
    line-height: 1.4;
    
    &:empty:before {
      content: '暂无筛选条件';
      color: #9ca3af;
      font-style: italic;
    }
  }
}


// ==================== 动画 ====================
@keyframes spin {
  0% { transform: rotate(0deg); }
  100% { transform: rotate(360deg); }
}

// ==================== 滚动优化 ====================
.hide-scrollbar {
  -webkit-overflow-scrolling: touch;
  &::-webkit-scrollbar {
    display: none;
  }
  -ms-overflow-style: none;
  scrollbar-width: none;
}

.quick-filter-tags,
.list-scroll {
  flex: 1;              // 新增：自动填满剩下高度
  height: 0;            // 新增：触发 BFC 计算
  overflow-y: scroll;
  @extend .hide-scrollbar;
}
.popup-body {
  @extend .hide-scrollbar;
}

// ==================== 响应式调整 ====================
@media (max-width: 320px) {
  .search-capsule {
    .search-main {
      .date-section {
        .date-num {
          font-size: 18px !important;
        }
        .date-month {
          font-size: 12px !important;
        }
      }
    }
  }
  
  .sort-bar .sort-item .sort-text {
    font-size: 14px !important;
  }
  
  .hotel-card {
    .hotel-image-container {
      width: 120px !important;
      height: 140px !important;
    }
  }
}// ==================== 2. 快速筛选标签行 ====================
.quick-filter-tags {
  padding: 10px 16px 8px;
  background: #fff;
  border-bottom: 1px solid #f0f0f0;
  width: 100%;
  
  .tags-container {
    display: flex;
    gap: 10px;
    padding: 4px 0;
    width: max-content; // 允许横向滚动
    
    .filter-tag {
      padding: 6px 16px;
      background: #f3f4f6;
      border-radius: 20px;
      border: 1px solid transparent;
      flex-shrink: 0;
      display: flex;
      align-items: center;
      justify-content: center;
      height: 32px; // 固定高度，刚好适配字体
      min-width: fit-content;
      transition: all 0.2s ease;
      
      &:active {
        background: #e5e7eb;
        transform: scale(0.98);
      }
      
      .tag-text {
        font-size: 16px; // 字体显著放大
        color: #374151;
        font-weight: 500;
        line-height: 1.2;
        white-space: nowrap;
      }
      
      // 激活状态
      &.active {
        background: $primary-light;
        border-color: $primary;
        
        .tag-text {
          color: $primary;
          font-weight: 600;
        }
      }
    }
  }
}

// ==================== 3. 排序栏 ====================
.sort-bar {
  display: flex;
  justify-content: space-around;
  align-items: center;
  padding: 16px 0;
  background: #fff;
  border-bottom: 1px solid $border-color;
  
  .sort-item {
    display: flex;
    align-items: center;
    padding: 10px 12px;
    position: relative;
    border-radius: 8px;
    transition: all 0.2s ease;
    
    // 激活状态
    &.active {
      background: $primary-light;
      
      .sort-text {
        color: $primary;
        font-weight: 700;
      }
      
      .sort-icon {
        color: $primary;
      }
    }
    
    // 点击效果
    &:active {
      background: #f3f4f6;
    }
    
    // 排序文本 - 继续放大
    .sort-text {
      font-size: 18px; // 从16px继续放大到18px
      color: $text-primary;
      font-weight: 600;
      margin-right: 6px;
      line-height: 1.2;
      white-space: nowrap;
    }
    
    // 排序图标
    .sort-icon {
      font-size: 14px;
      color: $text-secondary;
      line-height: 1;
    }
    
    // 筛选指示器（当有筛选条件时显示）
    .filter-indicator {
      position: absolute;
      top: 8px;
      right: 8px;
      width: 6px;
      height: 6px;
      background: $primary;
      border-radius: 3px;
      animation: pulse 2s infinite;
    }
  }
}

// ==================== 4. 筛选条件摘要 ====================
.filter-summary {
  padding: 10px 16px;
  background: #f8fafc;
  border-top: 1px solid #e5e7eb;
  
  .summary-text {
    font-size: 14px;
    color: $text-secondary;
    line-height: 1.4;
    
    &:empty:before {
      content: '暂无筛选条件';
      color: #9ca3af;
      font-style: italic;
    }
  }
}

// ==================== 动画效果 ====================
@keyframes pulse {
  0% {
    opacity: 1;
    transform: scale(1);
  }
  50% {
    opacity: 0.6;
    transform: scale(1.1);
  }
  100% {
    opacity: 1;
    transform: scale(1);
  }
}

@keyframes fadeIn {
  from {
    opacity: 0;
    transform: translateY(-10px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

.search-bar,
.quick-filter-tags,
.sort-bar,
.filter-summary {
  animation: fadeIn 0.3s ease;
}

// ==================== 滚动优化 ====================
.quick-filter-tags {
  -webkit-overflow-scrolling: touch;
  overflow-x: auto;
  
  &::-webkit-scrollbar {
    display: none;
  }
  
  -ms-overflow-style: none;
  scrollbar-width: none;
}

// ==================== 响应式调整 ====================
// 针对小屏幕的调整
@media (max-width: 320px) {
  .search-bar {
    .search-capsule-container {
      .search-capsule {
        // 城市部分
        .city-section {
          .city-name {
            font-size: 12px !important;
          }
        }
        
        // 日期部分
        .date-section {
          .date-container {
            .date-label,
            .date-value {
              font-size: 9px !important;
            }
          }
        }
        
        // 关键词部分
        .keyword-section {
          .keyword-text {
            font-size: 10px !important;
          }
        }
      }
    }
  }
  
  .quick-filter-tags {
    .tags-container {
      .filter-tag {
        padding: 5px 12px;
        height: 28px;
        
        .tag-text {
          font-size: 14px !important;
        }
      }
    }
  }
  
  .sort-bar {
    .sort-item {
      padding: 8px 10px;
      
      .sort-text {
        font-size: 16px !important;
      }
      
      .sort-icon {
        font-size: 12px !important;
      }
    }
  }
}

// 针对大屏幕的优化
@media (min-width: 400px) {
  .search-bar {
    .search-capsule-container {
      .search-capsule {
        // 城市部分
        .city-section {
          .city-name {
            font-size: 16px !important;
          }
        }
        
        // 日期部分
        .date-section {
          .date-container {
            .date-label,
            .date-value {
              font-size: 12px !important;
            }
          }
        }
        
        // 关键词部分
        .keyword-section {
          .keyword-text {
            font-size: 13px !important;
          }
        }
      }
    }
  }
  
  .quick-filter-tags {
    .tags-container {
      .filter-tag {
        height: 36px;
        
        .tag-text {
          font-size: 18px !important;
        }
      }
    }
  }
  
  .sort-bar {
    .sort-item {
      .sort-text {
        font-size: 20px !important;
      }
      
      .sort-icon {
        font-size: 16px !important;
      }
    }
  }
}

.loading-status-bar {
  width: 100%;
  padding: 50rpx 0 80rpx; // 增加底部间距，避免贴边
  display: flex;
  justify-content: center;
  align-items: center;
  clear: both;

  // 加载中/上滑加载的通用文字
  .status-loading {
    font-size: 24rpx;
    color: #9ca3af;
  }

  // “已经到底啦” 容器
  .no-more-container {
    display: flex;
    align-items: center;
    justify-content: center;
    width: 70%; // 控制横线总宽度

    .no-more-text {
      font-size: 24rpx; // 重点：字号更小，显得精致
      color: #d1d5db;   // 颜色更淡
      margin: 0 24rpx;  // 文字与线的间距
      white-space: nowrap;
    }

    .divider-line {
      flex: 1;
      height: 1rpx;
      background-color: #f0f0f0; // 极淡的分割线
    }
  }
}

// 确保父容器能撑开
.list-content {
  padding-bottom: 40rpx;
}