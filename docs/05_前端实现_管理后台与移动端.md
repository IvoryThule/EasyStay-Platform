# 05_前端实现_管理后台与移动端

## 5.1 管理后台：React 生态下的工程化实践
管理后台（admin-web）的设计核心在于解决 B 端业务特有的高度复杂性与强交互需求。我们选择了 React 18 搭配 Vite 作为底层构建引擎，这不仅赋予了系统毫秒级的热更新响应，更利用优秀的 ESM 构建特性优化了资源加载路径。为了承载商户酒店录入、房型管理及数据看板等高负载任务，项目引入了 Ant Design 组件库。我们在工程化实践中，通过对 AntD 基础组件的二次封装，建立了一套标准化的页面模板逻辑。例如，酒店编辑页面采用了声明式的 Form 管理模式，利用其内置的校验引擎实现了对 JSON 结构数据的实时校验，显著降低了由录入错误导致的后端接口报错率。

在架构层面，后台通过 Context API 构建了轻量级的全局状态管理体系。这一体系主要负责缓存当前登录者的角色权限（Admin 或 Merchant）及 JWT 令牌。为了实现对 API 访问的全局把控，我们在 `src/utils/request.js` 中定制了基于 Axios 的请求流水线。请求拦截器会自动从本地持久化存储中提取 `admin_token` 并注入到 HTTP Header 中，而响应拦截器则承担了核心的安全守卫工作：一旦监测到 401（Token 过期或非法）状态码，系统会自动执行注销逻辑并强制重定向至登录页。这种中心化的拦截机制，确保了业务代码无需关心底层的鉴权异常。

## 5.2 移动端：基于 Taro 的跨端适应性设计
移动端（mobile-app）面临的是碎片化的终端环境，因此我们采用了 Taro 跨端 React 框架。Taro 的选型不仅是为了实现 H5 与潜在小程序的基座共用，更是利用其编译器技术将类 React 代码转化为不同平台的高性能原生渲染指令。在样式方案上，通过 SCSS 结合 CSS 变量（CSS Variables）实现了细腻的主题化支持。移动端的 UI 交互逻辑侧重于轻快、灵敏，因此我们大量应用了 NutUI React 组件库中的动画反馈，并在首页检索页通过自定义 Hook 封装了地理位置联动搜索逻辑。用户在输入时的敏感度感知，正是通过防抖频率的精细化调整与前端预加载策略实现的。

针对多子路径部署的需求（如托管在 `/mobile/` 下），移动端在 `app.js` 入口处实现了复杂的路由适配策略。由于 H5 模式下 Hash 路由对基础路径的敏感性，我们通过解析当前 `window.location.pathname` 动态修正了路由基座。此外，在数据请求层面，移动端的 `request.js` 针对移动网络的弱连接特性进行了特别优化：除了常规的 Token 注入外，对于 GET 请求采取了精简头部字段的策略，旨在避开多余的 OPTIONS 预检请求（Preflight Requests），从而将首屏加载耗时缩短了约 300 毫秒。这种对底层协议层面的微调，极大地提升了终端用户的流畅度。

## 5.3 关键页面实现细节与组件通信模式
酒店详情页与 AI 聊天窗口是平台技术复杂度的集中体现。在详情页中，我们将页面拆分为多个独立的原子组件（如 Banner、RoomList、OrderPanel），利用 React 的单向数据流进行解耦。这种组件化的思路使得页面能够快速响应日期选择组件回传的状态变更，进而触发实时的总价计算与库存空余提示。在订单支付环节，前端通过一套严密的状态机校验前端表单完整性，随后发起异步调用，并在捕获到后端库存锁定成功的反馈后，平滑导向支付成功的反馈视图。通过这种异步任务的精细化排布，我们规避了传统跳转方式导致的 UI 闪烁问题。

AI 聊天页则展示了前端在处理非结构化流式数据方面的能力。我们设计了一个具备高度扩展性的 Message 渲染引擎，它能够识别后端返回的消息类型。如果消息中包含 `hotel_cards` 标签，引擎会动态加载预定义的酒店概览组件，并注入跳转至主详情页的路由指令。这种“文本与卡片”混排的模式，依赖于前端对上下文数组的深克隆维护与视图列表的自动滚动策略。与此同时，我们在前端实现了基于 SessionStorage 的会话持久化逻辑，确保用户在切换页面后重回聊天窗口时，能够瞬间恢复之前的策略推荐上下文，从而构建了一个具有持续感的智能助理体验。
