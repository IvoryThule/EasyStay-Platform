# EasyStay 酒店预订平台开发执行手册

*   **项目名称**：EasyStay-Platform
*   **GitHub 仓库**：`https://github.com/IvoryThule/EasyStay-Platform`
*   **开发周期**：2026.02.03 - 2026.02.24  （这个实训营的时间比较赶，所以春节期间可能也得占用一些时间）
*   **核心目标**：构建全栈酒店预订平台，集成 GLM-4.7 LLM 大模型 和 高德地图，实现服务器脚本化自动更新。

---

## 一、 自动化部署架构方案

为了满足“本地开发 -> GitHub -> 服务器更新”的流程，同时考虑到本人服务器在国内（腾讯云），拉取 GitHub 可能不稳定，因此我们采用 **GitHub -> Gitee (镜像) -> 服务器** 的链路。

**部署流程设计：**
1.  **开发**：我们在本地开发，Push代码到GitHub，注意提交信息需要符合规范
2.  **同步**：在 Gitee 上创建一个仓库，设置为“强制同步 GitHub”或手动点一下同步（解决网速问题）。
3.  **发布**：SSH 登录服务器，编写并执行`./update.sh`，脚本自动拉代码、安装依赖、重启服务。

---

## 二、 详细项目目录结构

```text
EasyStay-Platform/
├── .gitignore                      # [Git配置] 必须包含: node_modules, .env, dist, .DS_Store
├── README.md                       # [文档] 项目介绍、启动命令、成员分工说明
├── docker-compose.yml              # [运维] 编排 MySQL 8.0 容器的配置文件
│
├── .github/                        # (可选) GitHub 配置
│   └── workflows/                  # (可选) 如果未来做 GitHub Actions 可放这里
│
├── scripts/                        # [自动化运维] 存放自动化脚本
│   └── update.sh                   # [核心脚本] 服务器端一键更新、构建、部署脚本
│
├── deploy/                         # [部署配置]
│   └── nginx.conf                  # [Nginx配置] 核心反向代理规则 (api转发, 静态资源指向)
│
├── docs/                           # [项目文档]
│   ├── database_schema.md          # [设计] 数据库表结构、字段类型、关联关系说明
│   ├── api_interface.md            # [设计] 接口文档 (URL, Method, Params, Response)
│   └── dev_log.md                  # [记录] 开发日志 (统筹并记录每天的进度)
│
├── server/                         # [后端] Node.js + Express
│   ├── package.json                # [依赖] express, sequelize, mysql2, dotenv, cors, pm2, multer
│   ├── .env.example                # [配置] 环境变量模版 (提交到Git)，不含真实密码
│   ├── .env                        # [配置] 真实环境变量 (数据库密码, AI Key)
│   ├── app.js                      # [入口] 启动文件，配置中间件、静态资源、错误处理
│   ├── src/
│   │   ├── config/
│   │   │   └── database.js         # [配置] Sequelize 连接 MySQL 的实例配置
│   │   ├── models/                 # [ORM模型]
│   │   │   ├── index.js            # [入口] 初始化 DB，定义模型关联 (hasMany, belongsTo)
│   │   │   ├── User.js             # [表] 用户/商户/管理员
│   │   │   ├── Hotel.js            # [表] 酒店基础信息 (含 tags JSON字段)
│   │   │   ├── RoomType.js         # [表] 房型与价格 (关联 Hotel)
│   │   │   └── Order.js            # [表] 订单 (关联 User, Hotel, RoomType)
│   │   ├── middlewares/            # [中间件]
│   │   │   ├── authMiddleware.js   # [鉴权] 解析 JWT Token，将 user 挂载到 req
│   │   │   └── roleMiddleware.js   # [鉴权] 检查 req.user.role 是否为 admin/merchant
│   │   ├── routes/                 # [路由]
│   │   │   ├── authRoutes.js       # [API] /api/auth (login, register)
│   │   │   ├── hotelRoutes.js      # [API] /api/hotel (CRUD, list, detail)
│   │   │   ├── orderRoutes.js      # [API] /api/order (create, list)
│   │   │   ├── uploadRoutes.js     # [API] /api/upload (图片上传)
│   │   │   ├── aiRoutes.js         # [API] /api/ai (chat)
│   │   │   └── systemRoutes.js     # [API] /api/system (location, config)
│   │   ├── controllers/            # [逻辑]
│   │   │   ├── authController.js   # [代码] 登录注册逻辑
│   │   │   ├── hotelController.js  # [代码] 酒店筛选、录入、审核逻辑
│   │   │   ├── orderController.js  # [代码] 下单逻辑
│   │   │   └── aiController.js     # [代码] 构造 Prompt 调用 Service
│   │   ├── services/               # [外部服务]
│   │   │   ├── GLMService.js       # [封装] 调用 GLM API
│   │   │   └── amapService.js      # [封装] 调用高德 Web 服务 API
│   │   └── utils/
│   │       ├── response.js         # [工具] 统一返回格式 {code, msg, data}
│   │       └── passwordUtils.js    # [工具] bcrypt 加密/比对密码
│   └── uploads/                    # [资源] 图片存储目录 (内含 .gitkeep 防止空文件夹不被提交)
│
├── admin-web/                      # [前端PC] React + Vite + Ant Design（或者其他种类的组件）
│   ├── package.json                # [依赖] react, react-dom, antd, axios, react-router-dom
│   ├── vite.config.js              # [配置] 构建配置 (配置 proxy 解决本地跨域)
│   ├── index.html                  # [入口] HTML 模版
│   ├── src/
│   │   ├── main.jsx                # [入口] React 根节点挂载
│   │   ├── App.jsx                 # [路由] 配置路由表
│   │   ├── assets/                 # [资源] 静态图片、全局 CSS
│   │   ├── utils/
│   │   │   ├── request.js          # [工具] Axios 实例 (拦截器处理 Token)
│   │   │   └── constants.js        # [工具] 常量定义 (如: API_BASE_URL)
│   │   ├── components/             # [组件]
│   │   │   ├── MainLayout.jsx      # [布局] 侧边栏(Sider) + 头部(Header)
│   │   │   └── AuthGuard.jsx       # [路由守卫] 检查登录状态
│   │   └── pages/                  # [页面]
│   │       ├── Login.jsx           # [页面] 登录页
│   │       ├── Register.jsx        # [页面] 注册页
│   │       ├── HotelEdit.jsx       # [页面] 酒店录入 (商户)
│   │       ├── HotelAudit.jsx      # [页面] 酒店审核 (管理员)
│   │       └── Dashboard.jsx       # [页面] 欢迎页/仪表盘 (可选)
│   └── dist/                       # [构建产物] 执行 npm run build 后生成 (Git忽略)
│
└── mobile-app/                     # [前端移动端] Taro + NutUI React
    ├── package.json                # [依赖] @tarojs/cli, @nutui/nutui-react-taro
    ├── config/                     # [Taro配置]
    │   ├── index.js                # [配置] 基础配置 (设计稿尺寸等)
    │   ├── dev.js                  # [配置] 开发环境
    │   └── prod.js                 # [配置] 生产环境
    ├── src/
    │   ├── app.js                  # [入口] 全局逻辑
    │   ├── app.config.js           # [配置] 小程序全局配置 (pages, window, tabBar)
    │   ├── app.scss                # [样式] 全局样式 (定义黑夜模式 CSS 变量)
    │   ├── assets/                 # [资源] tabbar 图标等
    │   ├── context/
    │   │   └── ThemeContext.js     # [状态] 黑夜模式 Context Provider
    │   ├── utils/
    │   │   ├── request.js          # [工具] Taro.request 封装
    │   │   └── location.js         # [工具] 地理位置相关辅助函数
    │   ├── components/             # [组件]
    │   │   ├── AiFloatBall/        # [组件文件夹] AI 悬浮球
    │   │   │   ├── index.jsx       # [代码] 组件逻辑
    │   │   │   └── index.scss      # [样式] 组件样式
    │   │   └── HotelCard/          # [组件文件夹] 酒店列表卡片
    │   │       ├── index.jsx
    │   │       └── index.scss
    │   └── pages/                  # [页面]
    │       ├── index/              # [页面] 首页
    │       │   ├── index.jsx
    │       │   ├── index.config.js # [配置] 页面标题等
    │       │   └── index.scss
    │       ├── list/               # [页面] 列表页
    │       │   ├── index.jsx
    │       │   ├── index.config.js
    │       │   └── index.scss
    │       ├── detail/             # [页面] 详情页
    │       │   ├── index.jsx
    │       │   ├── index.config.js
    │       │   └── index.scss
    │       ├── login/              # [页面] 移动端登录
    │       │   ├── index.jsx
    │       │   └── index.scss
    │       └── user/               # [页面] 个人中心
    │           ├── index.jsx
    │           └── index.scss
    └── dist/                       # [构建产物] 执行 build:h5 后生成 (Git忽略)
```

---

## 三、 数据库设计 (Schema)

**1. users 表 (用户)**
*   `id`: INT (PK)
*   `username`: VARCHAR
*   `password`: VARCHAR (加密存储)
*   `role`: ENUM('user', 'merchant', 'admin') **(区分C端用户、商户、管理员)**
*   `avatar`: VARCHAR (头像)

**2. hotels 表 (酒店核心)**
*   `id`: INT (PK)
*   `name`: VARCHAR
*   `address`: VARCHAR
*   `city`: VARCHAR (用于定位匹配)
*   `price`: DECIMAL (最低起步价，用于列表展示)
*   `star`: INT (1-5 星级)
*   `tags`: JSON (例: `["亲子", "免费停车", "近地铁"]`) - **快捷标签**
*   `cover_image`: VARCHAR
*   `status`: INT (0:审核中, 1:已发布, 2:驳回, 3:下线) - **审核状态**
*   `merchant_id`: INT (FK -> users.id)
*   `latitude`: DOUBLE (纬度)
*   `longitude`: DOUBLE (经度)

**3. room_types 表 (房型与价格)
*   **对应题目 3.5 房型价格列表**
*   `id`: INT (PK)
*   `hotel_id`: INT (FK)
*   `name`: VARCHAR (例: "豪华大床房")
*   `price`: DECIMAL (例: 399.00)
*   `stock`: INT (库存)

**4. orders 表 (简易订单)
*   **对应预订流程闭环**
*   `id`: INT (PK)
*   `user_id`: INT (FK)
*   `hotel_id`: INT (FK)
*   `room_type_id`: INT (FK)
*   `check_in`: DATE
*   `check_out`: DATE
*   `status`: INT (0:待支付, 1:已预订, 2:已取消)

---

## 四、职责分配以及参考开发计划表 
(由于本人粗心，今天才看到题目，就没提前开发一部分，所以时间可能比较紧张，今晚我先把框架打好)
### 职责分配

#### 陶恒轩 (全栈架构 & 兜底)
*   **职责**：
    1.  **服务器/DevOps**：搞定 Docker, Nginx, SSL, 自动化脚本 (`update.sh`)。
    2.  **后端核心**：设计数据库，写 Node.js 核心接口 (Auth, Upload, AI Service)。
    3.  **接口定义**：在写代码前，先定义好 API 文档（输入什么，返回什么），让另外两位同学能写 Mock 数据。
    4.  **Code Review**：最后把关另外两位的代码，解决 Git 冲突。

#### 史乙彤 (移动端前端开发)
*   **职责**：
    1.  **Taro App 开发**：首页、列表页、详情页、个人中心。
    2.  **交互实现**：黑夜模式切换、上滑加载更多、Banner 轮播等。
    3.  **前端组件开发**：基础以及可复用组件的开发。

#### 王宇涛 (PC 端前端开发)
*   **利用 Vibe Coding 优势**：管理后台主要是 CRUD（增删改查）和表单，AI 生成 Ant Design 的 Table 和 Form 代码准确率还是很高的。
*   **职责**：
    1.  **React Admin 开发**：登录页、布局容器 (Layout)等。
    2.  **核心表单**：酒店信息录入页（这是最复杂的表单，含图片上传）。
    3.  **核心表格**：审核列表页（含筛选、分页、操作弹窗）。
---