name: Sync to Gitee

on:
  #push:
    #branches: [ master, main ] # 包含 master 和 main，防止分支名不一致
  workflow_dispatch: # 允许在 GitHub Actions 页面手动触发

jobs:
  sync:
    runs-on: ubuntu-22.04
    steps:
      - name: Checkout GitHub Code
        uses: actions/checkout@v4
        with:
          fetch-depth: 0 # 拉取所有历史

      - name: Mirror to Gitee
        uses: Yikun/hub-mirror-action@master
        with:
          # 源端（GitHub）
          src: github/IvoryThule
          # 目标端（Gitee）
          dst: gitee/IvoryThule
          # Gitee 的私钥（对应 Secrets）
          dst_key: ${{ secrets.GITEE_PRIVATE_KEY }}
          # Gitee 的 Token（用于创建仓库）
          dst_token: ${{ secrets.GITEE_TOKEN }}
          # 只同步当前仓库
          static_list: "EasyStay-Platform"
          # 强制更新（避免因为提交历史不一致导致的同步失败）
          force_update: true
          # 调试模式，如果出错可以看到更多信息
          debug: true
